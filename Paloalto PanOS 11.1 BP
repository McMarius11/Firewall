# set command configuration for panos v11.1
# commands are expected to be loaded in order
# this template uses jinja format
# either 'search and replace' or the scripts in the tools dir can be used to create a loadable configuration
# a strong modified version of https://github.com/PaloAltoNetworks/iron-skillet
# last edit 15.02.2025 by Marius Kamm


OPTIONAL--------OPTIONAL-------------OPTIONAL--------------OPTIONAL--------------------OPTIONAL

# remove admin/admin default and add user defined super user
set mgt-config users {{ ADMINISTRATOR_USERNAME }} password
set mgt-config users {{ ADMINISTRATOR_USERNAME }} permissions role-based superuser yes

# best-practice to remove user=admin
#delete mgt-config users admin

set deviceconfig setting management admin-lockout failed-attempts 5
set deviceconfig setting management admin-lockout lockout-time 30
set deviceconfig setting management idle-timeout 10
set deviceconfig setting management auto-acquire-commit-lock yes

# set password complexity - will not impact existing users
set mgt-config password-complexity enabled yes
set mgt-config password-complexity minimum-length 12
set mgt-config password-complexity minimum-uppercase-letters 1
set mgt-config password-complexity minimum-lowercase-letters 1
set mgt-config password-complexity minimum-numeric-letters 1
set mgt-config password-complexity minimum-special-characters 1
set mgt-config password-complexity block-username-inclusion yes
set mgt-config password-complexity password-history-count 24
set mgt-config password-complexity new-password-differs-by-characters 3

OPTIONAL--------OPTIONAL-------------OPTIONAL--------------OPTIONAL--------------------OPTIONAL


#  ___                   _     _   _                _         _ 
# |_ _|_ __  _ __  _   _| |_  | \ | | ___  ___   __| | ___  __| |
# | || '_ \| '_ \| | | | __| |  \| |/ _ \/ _ \ / _` |/ _ \/ _` |
# | || | | | |_) | |_| | |_  | |\  |  __/  __/| (_| |  __/ (_| |
# |___|_| |_| .__/ \__,_|\__| |_| \_|\___|\___| \__,_|\___|\__,_|
#           |_|                                                  


# management interface configuration - may be skipped if already online
set deviceconfig system hostname {{ FW_NAME }}
set deviceconfig system ip-address {{ MGMT_IP }}
set deviceconfig system netmask {{ MGMT_MASK }}
set deviceconfig system default-gateway {{ MGMT_DG }}
set deviceconfig system dns-setting servers primary {{ DNS_1 }}
set deviceconfig system dns-setting servers secondary {{ DNS_2 }}


# NTP configuration
set deviceconfig system ntp-servers primary-ntp-server ntp-server-address {{ NTP_1 }}
set deviceconfig system ntp-servers secondary-ntp-server ntp-server-address {{ NTP_2 }}

# Antivirus and Apps/Threats are needed for EDLs
request content upgrade check
request content upgrade download latest 
request content upgrade install version latest 

request anti-virus upgrade check
request anti-virus upgrade download latest
request anti-virus upgrade install version latest



# device system and settings configuration
set deviceconfig system update-schedule threats recurring every-30-mins at 2
set deviceconfig system update-schedule threats recurring every-30-mins action download-and-install
set deviceconfig system update-schedule threats recurring threshold 12
set deviceconfig system update-schedule anti-virus recurring hourly at 4
set deviceconfig system update-schedule anti-virus recurring hourly action download-and-install
set deviceconfig system update-schedule wildfire recurring real-time
set deviceconfig system update-schedule global-protect-datafile recurring hourly at 40
set deviceconfig system update-schedule global-protect-datafile recurring hourly action download-and-install
set deviceconfig system update-schedule global-protect-clientless-vpn recurring hourly at 50
set deviceconfig system update-schedule global-protect-clientless-vpn recurring hourly action download-and-install
set deviceconfig system snmp-setting access-setting version v3
set deviceconfig system login-banner "You have accessed a protected system. Log off immediately if you are not an authorized user."
set deviceconfig system timezone Europe/Berlin
set deviceconfig setting wildfire public-cloud-server de.wildfire.paloaltonetworks.com


# Objects
set address fqdn_sinkhole.paloaltonetworks.com fqdn sinkhole.paloaltonetworks.com
set address n_RFC1918_10.0.0.0-8 ip-netmask 10.0.0.0/8
set address n_RFC1918_172.16.0.0-12 ip-netmask 172.16.0.0/12
set address n_RFC1918_192.168.0.0-16 ip-netmask 192.168.0.0/16
set address-group ag_RFC1918 static [ n_RFC1918_10.0.0.0-8 n_RFC1918_172.16.0.0-12 n_RFC1918_192.168.0.0-16 ]

#Device Log Settings for Panorama
set shared log-settings system match-list System_Log_Forwarding filter "All Logs"
set shared log-settings system match-list System_Log_Forwarding send-to-panorama yes
set shared log-settings config match-list Configuration_Log_Forwarding filter "All Logs"
set shared log-settings config match-list Configuration_Log_Forwarding send-to-panorama yes
set shared log-settings userid match-list User-ID_Log_Forwarding filter "All Logs"
set shared log-settings userid match-list User-ID_Log_Forwarding send-to-panorama yes
set shared log-settings hipmatch match-list HIP_Log_Forwarding filter "All Logs"
set shared log-settings hipmatch match-list HIP_Log_Forwarding send-to-panorama yes
set shared log-settings globalprotect match-list GP_Log_Forwarding filter "All Logs"
set shared log-settings globalprotect match-list GP_Log_Forwarding send-to-panorama yes
set shared log-settings iptag match-list IP-Tag_Log_Forwarding filter "All Logs"
set shared log-settings iptag match-list IP-Tag_Log_Forwarding send-to-panorama yes

#Log Forwarding Profile Objects for Panorama
set shared log-settings profiles default match-list Traffic_Log_Forwarding log-type traffic
set shared log-settings profiles default match-list Traffic_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Traffic_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Threat_Log_Forwarding log-type threat
set shared log-settings profiles default match-list Threat_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Threat_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Email_Malicious_Verdicts action-desc "Email Malicious Wildfire Verdicts"
set shared log-settings profiles default match-list Email_Malicious_Verdicts log-type wildfire
set shared log-settings profiles default match-list Email_Malicious_Verdicts filter "(verdict neq benign)"
set shared log-settings profiles default match-list Email_Malicious_Verdicts send-to-panorama yes
set shared log-settings profiles default match-list Wildfire_Log_Forwarding log-type wildfire
set shared log-settings profiles default match-list Wildfire_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Wildfire_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list URL_Log_Forwarding log-type url
set shared log-settings profiles default match-list URL_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list URL_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Data_Log_Forwarding log-type data
set shared log-settings profiles default match-list Data_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Data_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Tunnel_Log_Forwarding log-type tunnel
set shared log-settings profiles default match-list Tunnel_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Tunnel_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Auth_Log_Forwarding log-type auth
set shared log-settings profiles default match-list Auth_Log_Forwarding filter "All Logs"
set shared log-settings profiles default match-list Auth_Log_Forwarding send-to-panorama yes
set shared log-settings profiles default match-list Decryption log-type decryption
set shared log-settings profiles default match-list Decryption filter "All Logs"
set shared log-settings profiles default match-list Decryption send-to-panorama yes


#Tags referenced in security rules
set tag Outbound comments "Outbound to the Internet"
set tag Inbound comments "Inbound from the Internet"
set tag Internal comments "Internal to Internal"
set tag deny comments "Traffic who gets denied"


#File Blocking Profile
#set profiles file-blocking Outbound-FB rules Alert-All application any
#set profiles file-blocking Outbound-FB rules Alert-All file-type any
#set profiles file-blocking Outbound-FB rules Alert-All direction both
#set profiles file-blocking Outbound-FB rules Alert-All action alert
#set profiles file-blocking Outbound-FB rules Block application any
#set profiles file-blocking Outbound-FB rules Block file-type [ 7z bat chm class cpl dll hlp hta jar ocx pif scr torrent vbe wsf ]
#set profiles file-blocking Outbound-FB rules Block direction both
#set profiles file-blocking Outbound-FB rules Block action block

set profiles file-blocking Alert-Only-FB rules Alert-Only application any
set profiles file-blocking Alert-Only-FB rules Alert-Only file-type any
set profiles file-blocking Alert-Only-FB rules Alert-Only direction both
set profiles file-blocking Alert-Only-FB rules Alert-Only action alert

#Anti-Spyware Profile with Sinkholing
set profiles spyware Outbound-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains lists default-paloalto-dns action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-benign action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-cc action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-parked log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-parked action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-parked packet-capture disable
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-malware action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-recent action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet
set profiles spyware Outbound-AS rules Block-Critical-High-Medium action reset-both
set profiles spyware Outbound-AS rules Block-Critical-High-Medium severity [ high critical medium ]
set profiles spyware Outbound-AS rules Block-Critical-High-Medium threat-name any
set profiles spyware Outbound-AS rules Block-Critical-High-Medium category any
set profiles spyware Outbound-AS rules Block-Critical-High-Medium packet-capture single-packet
set profiles spyware Outbound-AS rules Default-Low-Info action default
set profiles spyware Outbound-AS rules Default-Low-Info severity [ low informational ]
set profiles spyware Outbound-AS rules Default-Low-Info threat-name any
set profiles spyware Outbound-AS rules Default-Low-Info category any
set profiles spyware Outbound-AS rules Default-Low-Info packet-capture disable
set profiles spyware Outbound-AS cloud-inline-analysis yes
set profiles spyware Outbound-AS mica-engine-spyware-enabled "HTTP Command and Control detector" inline-policy-action reset-both
set profiles spyware Outbound-AS mica-engine-spyware-enabled "HTTP2 Command and Control detector" inline-policy-action reset-both
set profiles spyware Outbound-AS mica-engine-spyware-enabled "SSL Command and Control detector" inline-policy-action reset-both
set profiles spyware Outbound-AS mica-engine-spyware-enabled "Unknown-TCP Command and Control detector" inline-policy-action reset-both
set profiles spyware Outbound-AS mica-engine-spyware-enabled "Unknown-UDP Command and Control detector" inline-policy-action reset-both
set profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-dns packet-capture disable
set profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-dns action alert
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-benign action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-cc action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-ddns action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-grayware log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-grayware action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-grayware packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-parked log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-parked action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-parked packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-phishing log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-phishing action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-phishing packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-proxy log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-proxy action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-proxy packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-malware action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-recent action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet
set profiles spyware Alert-Only-AS rules Alert-All action alert
set profiles spyware Alert-Only-AS rules Alert-All severity any
set profiles spyware Alert-Only-AS rules Alert-All threat-name any
set profiles spyware Alert-Only-AS rules Alert-All category any
set profiles spyware Alert-Only-AS rules Alert-All packet-capture disable
set profiles spyware Alert-Only-AS cloud-inline-analysis yes
set profiles spyware Alert-Only-AS mica-engine-spyware-enabled "HTTP Command and Control detector" inline-policy-action alert
set profiles spyware Alert-Only-AS mica-engine-spyware-enabled "HTTP2 Command and Control detector" inline-policy-action alert
set profiles spyware Alert-Only-AS mica-engine-spyware-enabled "SSL Command and Control detector" inline-policy-action alert
set profiles spyware Alert-Only-AS mica-engine-spyware-enabled "Unknown-TCP Command and Control detector" inline-policy-action alert
set profiles spyware Alert-Only-AS mica-engine-spyware-enabled "Unknown-UDP Command and Control detector" inline-policy-action alert

#URL Filtering Profile
set profiles custom-url-category Block type "URL List"
set profiles custom-url-category Allow type "URL List"
set profiles custom-url-category Custom-No-Decrypt type "URL List"
set profiles url-filtering Outbound-URL credential-enforcement mode ip-user 
set profiles url-filtering Outbound-URL credential-enforcement log-severity high
set profiles url-filtering Outbound-URL credential-enforcement alert [ Allow computer-and-internet-info low-risk remote-access ]
set profiles url-filtering Outbound-URL credential-enforcement block [ Block abortion abused-drugs adult AI-code-assistant AI-conversational-assistant AI-data-and-workflow-optimizer AI-media-service AI-meeting-assistant AI-platform-service AI-website-generator AI-writing-assistant alcohol-and-tobacco artificial-intelligence auctions business-and-economy command-and-control compromised-website content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions encrypted-dns entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal malware marijuana medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable ransomware real-estate real-time-detection recreation-and-hobbies reference-and-research religion scanning-activity search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting ]
set profiles url-filtering Outbound-URL log-http-hdr-user-agent yes
set profiles url-filtering Outbound-URL log-http-hdr-referer yes
set profiles url-filtering Outbound-URL log-http-hdr-xff yes
set profiles url-filtering Outbound-URL local-inline-cat yes
set profiles url-filtering Outbound-URL cloud-inline-cat yes
set profiles url-filtering Outbound-URL alert [ Allow abortion AI-code-assistant AI-conversational-assistant AI-data-and-workflow-optimizer AI-media-service AI-meeting-assistant AI-platform-service AI-website-generator AI-writing-assistant alcohol-and-tobacco artificial-intelligence auctions business-and-economy computer-and-internet-info content-delivery-networks cryptocurrency dating educational-institutions entertainment-and-arts financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses questionable real-estate recreation-and-hobbies reference-and-research religion remote-access search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting ]
set profiles url-filtering Outbound-URL block [ Block abused-drugs adult command-and-control compromised-website copyright-infringement dynamic-dns encrypted-dns extremism grayware malware marijuana phishing proxy-avoidance-and-anonymizers ransomware real-time-detection scanning-activity ]


set profiles url-filtering Alert-Only-URL credential-enforcement mode ip-user 
set profiles url-filtering Alert-Only-URL credential-enforcement log-severity medium
set profiles url-filtering Alert-Only-URL credential-enforcement alert [ Allow Block abortion abused-drugs adult AI-code-assistant AI-conversational-assistant AI-data-and-workflow-optimizer AI-media-service AI-meeting-assistant AI-platform-service AI-website-generator AI-writing-assistant alcohol-and-tobacco artificial-intelligence auctions business-and-economy command-and-control compromised-website computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions encrypted-dns entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware marijuana medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate real-time-detection recreation-and-hobbies reference-and-research religion remote-access search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting ]
set profiles url-filtering Alert-Only-URL credential-enforcement block [ phishing ransomware scanning-activity ]
set profiles url-filtering Alert-Only-URL log-http-hdr-user-agent yes
set profiles url-filtering Alert-Only-URL log-http-hdr-referer yes
set profiles url-filtering Alert-Only-URL log-http-hdr-xff yes
set profiles url-filtering Alert-Only-URL local-inline-cat yes
set profiles url-filtering Alert-Only-URL cloud-inline-cat yes
set profiles url-filtering Alert-Only-URL alert [ Allow Block abortion abused-drugs adult AI-code-assistant AI-conversational-assistant AI-data-and-workflow-optimizer AI-media-service AI-meeting-assistant AI-platform-service AI-website-generator AI-writing-assistant alcohol-and-tobacco artificial-intelligence auctions business-and-economy command-and-control compromised-website computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions encrypted-dns entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware marijuana medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate real-time-detection recreation-and-hobbies reference-and-research religion remote-access search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting ]
set profiles url-filtering Alert-Only-URL block [ phishing ransomware scanning-activity ]



#AntiVirus Profiles
set profiles virus Alert-Only-AV decoder ftp action alert
set profiles virus Alert-Only-AV decoder ftp wildfire-action alert
set profiles virus Alert-Only-AV decoder ftp mlav-action alert
set profiles virus Alert-Only-AV decoder http action alert
set profiles virus Alert-Only-AV decoder http wildfire-action alert
set profiles virus Alert-Only-AV decoder http mlav-action alert
set profiles virus Alert-Only-AV decoder http2 action alert
set profiles virus Alert-Only-AV decoder http2 wildfire-action alert
set profiles virus Alert-Only-AV decoder http2 mlav-action alert
set profiles virus Alert-Only-AV decoder imap action alert
set profiles virus Alert-Only-AV decoder imap wildfire-action alert
set profiles virus Alert-Only-AV decoder imap mlav-action alert
set profiles virus Alert-Only-AV decoder pop3 action alert
set profiles virus Alert-Only-AV decoder pop3 wildfire-action alert
set profiles virus Alert-Only-AV decoder pop3 mlav-action alert
set profiles virus Alert-Only-AV decoder smb action alert
set profiles virus Alert-Only-AV decoder smb wildfire-action alert
set profiles virus Alert-Only-AV decoder smb mlav-action alert
set profiles virus Alert-Only-AV decoder smtp action alert
set profiles virus Alert-Only-AV decoder smtp wildfire-action alert
set profiles virus Alert-Only-AV decoder smtp mlav-action alert
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "MSOffice" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "Shell" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "OOXML" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "MachO" mlav-policy-action enable(alert-only)

set profiles virus Outbound-AV decoder ftp action reset-both
set profiles virus Outbound-AV decoder ftp wildfire-action reset-both
set profiles virus Outbound-AV decoder ftp mlav-action reset-both
set profiles virus Outbound-AV decoder http action reset-both
set profiles virus Outbound-AV decoder http wildfire-action reset-both
set profiles virus Outbound-AV decoder http mlav-action reset-both
set profiles virus Outbound-AV decoder http2 action reset-both
set profiles virus Outbound-AV decoder http2 wildfire-action reset-both
set profiles virus Outbound-AV decoder http2 mlav-action reset-both
set profiles virus Outbound-AV decoder imap action reset-both
set profiles virus Outbound-AV decoder imap wildfire-action reset-both
set profiles virus Outbound-AV decoder imap mlav-action reset-both
set profiles virus Outbound-AV decoder pop3 action reset-both
set profiles virus Outbound-AV decoder pop3 wildfire-action reset-both
set profiles virus Outbound-AV decoder pop3 mlav-action reset-both
set profiles virus Outbound-AV decoder smb action reset-both
set profiles virus Outbound-AV decoder smb wildfire-action reset-both
set profiles virus Outbound-AV decoder smb mlav-action reset-both
set profiles virus Outbound-AV decoder smtp action reset-both
set profiles virus Outbound-AV decoder smtp wildfire-action reset-both
set profiles virus Outbound-AV decoder smtp mlav-action reset-both
set profiles virus Outbound-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "MSOffice" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "Shell" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "OOXML" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "MachO" mlav-policy-action enable

#Vulnerability Protection Profile
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium action reset-both
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium vendor-id any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium severity [ critical high medium ]
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium cve any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium threat-name any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium host any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium category any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium packet-capture single-packet
set profiles vulnerability Outbound-VP rules Default-Low-Info action default
set profiles vulnerability Outbound-VP rules Default-Low-Info vendor-id any
set profiles vulnerability Outbound-VP rules Default-Low-Info severity [ low informational ]
set profiles vulnerability Outbound-VP rules Default-Low-Info cve any
set profiles vulnerability Outbound-VP rules Default-Low-Info threat-name any
set profiles vulnerability Outbound-VP rules Default-Low-Info host any
set profiles vulnerability Outbound-VP rules Default-Low-Info category any
set profiles vulnerability Outbound-VP rules Default-Low-Info packet-capture disable
set profiles vulnerability Outbound-VP cloud-inline-analysis yes
set profiles vulnerability Outbound-VP mica-engine-vulnerability-enabled "SQL Injection" inline-policy-action reset-both
set profiles vulnerability Outbound-VP mica-engine-vulnerability-enabled "Command Injection" inline-policy-action reset-both
set profiles vulnerability Alert-Only-VP rules Alert-All action alert
set profiles vulnerability Alert-Only-VP rules Alert-All vendor-id any
set profiles vulnerability Alert-Only-VP rules Alert-All severity any
set profiles vulnerability Alert-Only-VP rules Alert-All cve any
set profiles vulnerability Alert-Only-VP rules Alert-All threat-name any
set profiles vulnerability Alert-Only-VP rules Alert-All host any
set profiles vulnerability Alert-Only-VP rules Alert-All category any
set profiles vulnerability Alert-Only-VP rules Alert-All packet-capture disable
set profiles vulnerability Alert-Only-VP cloud-inline-analysis yes
set profiles vulnerability Alert-Only-VP mica-engine-vulnerability-enabled "SQL Injection" inline-policy-action alert
set profiles vulnerability Alert-Only-VP mica-engine-vulnerability-enabled "Command Injection" inline-policy-action alert


#Wildfire Analysis Profiles
set profiles wildfire-analysis Outbound-WF rules Forward-All application any
set profiles wildfire-analysis Outbound-WF rules Forward-All file-type any
set profiles wildfire-analysis Outbound-WF rules Forward-All direction both
set profiles wildfire-analysis Outbound-WF rules Forward-All analysis public-cloud
set profiles wildfire-analysis Outbound-WF cloud-inline-analysis yes

set profiles wildfire-analysis Alert-Only-WF rules Forward-All application any
set profiles wildfire-analysis Alert-Only-WF rules Forward-All file-type any
set profiles wildfire-analysis Alert-Only-WF rules Forward-All direction both
set profiles wildfire-analysis Alert-Only-WF rules Forward-All analysis public-cloud
set profiles wildfire-analysis Alert-Only-WF cloud-inline-analysis yes

#Profile Groups


set profile-group Alert-Only virus Alert-Only-AV
set profile-group Alert-Only spyware Alert-Only-AS
set profile-group Alert-Only vulnerability Alert-Only-VP
set profile-group Alert-Only url-filtering Alert-Only-URL
set profile-group Alert-Only file-blocking Alert-Only-FB
set profile-group Alert-Only wildfire-analysis Alert-Only-WF


set profile-group default virus Outbound-AV
set profile-group default spyware Outbound-AS
set profile-group default vulnerability Outbound-VP
set profile-group default url-filtering Outbound-URL
set profile-group default file-blocking Outbound-FB
set profile-group default wildfire-analysis Outbound-WF

#Security Rules
set rulebase default-security-rules rules intrazone-default action drop
set rulebase default-security-rules rules intrazone-default log-start no
set rulebase default-security-rules rules intrazone-default log-end yes
set rulebase default-security-rules rules intrazone-default log-setting default
set rulebase default-security-rules rules interzone-default action drop
set rulebase default-security-rules rules interzone-default log-start no
set rulebase default-security-rules rules interzone-default log-end yes
set rulebase default-security-rules rules interzone-default log-setting default
set rulebase security rules "Outbound EDL Block Rule" description "Block outbound sessions with destination address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses and also tor exit ips."
set rulebase security rules "Outbound EDL Block Rule" to any
set rulebase security rules "Outbound EDL Block Rule" from any
set rulebase security rules "Outbound EDL Block Rule" source any
set rulebase security rules "Outbound EDL Block Rule" destination [ panw-highrisk-ip-list panw-known-ip-list panw-bulletproof-ip-list panw-torexit-ip-list ]
set rulebase security rules "Outbound EDL Block Rule" source-user any
set rulebase security rules "Outbound EDL Block Rule" category any
set rulebase security rules "Outbound EDL Block Rule" application any
set rulebase security rules "Outbound EDL Block Rule" service any
set rulebase security rules "Outbound EDL Block Rule" source-hip any
set rulebase security rules "Outbound EDL Block Rule" action drop
set rulebase security rules "Outbound EDL Block Rule" log-setting default
set rulebase security rules "Outbound EDL Block Rule" tag [ Outbound deny ]
set rulebase security rules "Outbound EDL Block Rule" group-tag deny

set rulebase security rules "Inbound EDL Block Rule" description "Block inbound sessions with source address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses and also tor exit ips."
set rulebase security rules "Inbound EDL Block Rule" to any
set rulebase security rules "Inbound EDL Block Rule" from any
set rulebase security rules "Inbound EDL Block Rule" source [ panw-highrisk-ip-list panw-known-ip-list panw-bulletproof-ip-list panw-torexit-ip-list ]
set rulebase security rules "Inbound EDL Block Rule" destination any
set rulebase security rules "Inbound EDL Block Rule" source-user any
set rulebase security rules "Inbound EDL Block Rule" category any
set rulebase security rules "Inbound EDL Block Rule" application any
set rulebase security rules "Inbound EDL Block Rule" service any
set rulebase security rules "Inbound EDL Block Rule" source-hip any
set rulebase security rules "Inbound EDL Block Rule" action drop
set rulebase security rules "Inbound EDL Block Rule" log-setting default
set rulebase security rules "Inbound EDL Block Rule" tag [ Inbound deny ]
set rulebase security rules "Inbound EDL Block Rule" group-tag deny



set rulebase security rules "Paloalto DNS Sinkhole" to any
set rulebase security rules "Paloalto DNS Sinkhole" from any
set rulebase security rules "Paloalto DNS Sinkhole" source any
set rulebase security rules "Paloalto DNS Sinkhole" destination fqdn_sinkhole.paloaltonetworks.com
set rulebase security rules "Paloalto DNS Sinkhole" source-user any
set rulebase security rules "Paloalto DNS Sinkhole" category any
set rulebase security rules "Paloalto DNS Sinkhole" application any
set rulebase security rules "Paloalto DNS Sinkhole" service any
set rulebase security rules "Paloalto DNS Sinkhole" source-hip any
set rulebase security rules "Paloalto DNS Sinkhole" destination-hip any
set rulebase security rules "Paloalto DNS Sinkhole" action deny
set rulebase security rules "Paloalto DNS Sinkhole" log-start no
set rulebase security rules "Paloalto DNS Sinkhole" log-end yes
set rulebase security rules "Paloalto DNS Sinkhole" log-setting default
set rulebase security rules "Paloalto DNS Sinkhole" group-tag deny
set rulebase security rules "Paloalto DNS Sinkhole" tag deny


#Recommended Decryption Profiles
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-expired-certificate yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-untrusted-issuer yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unknown-cert yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-timeout-cert yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unsupported-version yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unsupported-cipher yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy restrict-cert-exts no
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy auto-include-altname yes
set profiles decryption Recommended_Decryption_Profile ssl-no-proxy block-expired-certificate yes
set profiles decryption Recommended_Decryption_Profile ssl-no-proxy block-untrusted-issuer yes
set profiles decryption Recommended_Decryption_Profile ssl-inbound-proxy block-unsupported-version yes
set profiles decryption Recommended_Decryption_Profile ssl-inbound-proxy block-unsupported-cipher yes
set profiles decryption Recommended_Decryption_Profile ssh-proxy block-unsupported-version no
set profiles decryption Recommended_Decryption_Profile ssh-proxy block-unsupported-alg no
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings min-version tls1-2
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings max-version tls1-3
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings keyxchg-algo-rsa yes
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings enc-algo-3des no
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings enc-algo-rc4 no
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings auth-algo-sha1 yes

#Recommended Decryption NO DECRYPT rules for SSL checks even if not decrypting
set rulebase decryption rules "NO-Decrypt URL Categories" category [ financial-services government health-and-medicine Custom-No-Decrypt ]
set rulebase decryption rules "NO-Decrypt URL Categories" service any
set rulebase decryption rules "NO-Decrypt URL Categories" type ssl-forward-proxy
set rulebase decryption rules "NO-Decrypt URL Categories" from any
set rulebase decryption rules "NO-Decrypt URL Categories" to any
set rulebase decryption rules "NO-Decrypt URL Categories" source any
set rulebase decryption rules "NO-Decrypt URL Categories" destination any
set rulebase decryption rules "NO-Decrypt URL Categories" source-user any
set rulebase decryption rules "NO-Decrypt URL Categories" profile Recommended_Decryption_Profile
set rulebase decryption rules "NO-Decrypt URL Categories" action no-decrypt
set rulebase decryption rules "NO-Decrypt URL Categories" disabled yes
set rulebase decryption rules "NO-Decrypt URL Categories" description "This rule does not do Decryption.  This rule is validating SSL Protocol Communications."

#Zone Protection Profiles - To Be Added to each Configured Zone
set network profiles zone-protection-profile Best_Practice_External flood tcp-syn syn-cookies alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood tcp-syn syn-cookies activate-rate 0
set network profiles zone-protection-profile Best_Practice_External flood tcp-syn syn-cookies maximal-rate 1000000
set network profiles zone-protection-profile Best_Practice_External flood tcp-syn enable no
set network profiles zone-protection-profile Best_Practice_External flood udp red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood udp red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood udp red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_External flood udp enable no
set network profiles zone-protection-profile Best_Practice_External flood icmp red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood icmp red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood icmp red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_External flood icmp enable no
set network profiles zone-protection-profile Best_Practice_External flood icmpv6 red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood icmpv6 red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood icmpv6 red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_External flood icmpv6 enable no
set network profiles zone-protection-profile Best_Practice_External flood other-ip red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood other-ip red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_External flood other-ip red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_External flood other-ip enable no
set network profiles zone-protection-profile Best_Practice_External scan 8001 action alert 
set network profiles zone-protection-profile Best_Practice_External scan 8001 interval 2
set network profiles zone-protection-profile Best_Practice_External scan 8001 threshold 100
set network profiles zone-protection-profile Best_Practice_External scan 8002 action alert 
set network profiles zone-protection-profile Best_Practice_External scan 8002 interval 10
set network profiles zone-protection-profile Best_Practice_External scan 8002 threshold 100
set network profiles zone-protection-profile Best_Practice_External scan 8003 action alert 
set network profiles zone-protection-profile Best_Practice_External scan 8003 interval 2
set network profiles zone-protection-profile Best_Practice_External scan 8003 threshold 100
set network profiles zone-protection-profile Best_Practice_External discard-unknown-option yes
set network profiles zone-protection-profile Best_Practice_External discard-malformed-option yes
set network profiles zone-protection-profile Best_Practice_External ipv6 routing-header-0 no
set network profiles zone-protection-profile Best_Practice_External ipv6 routing-header-1 no
set network profiles zone-protection-profile Best_Practice_External ipv6 routing-header-4-252 no
set network profiles zone-protection-profile Best_Practice_External ipv6 routing-header-255 no
set network profiles zone-protection-profile Best_Practice_External discard-ip-spoof no
set network profiles zone-protection-profile Best_Practice_External strict-ip-check no
set network profiles zone-protection-profile Best_Practice_External discard-strict-source-routing yes
set network profiles zone-protection-profile Best_Practice_External discard-loose-source-routing yes
set network profiles zone-protection-profile Best_Practice_External discard-tcp-split-handshake yes
set network profiles zone-protection-profile Best_Practice_External discard-overlapping-tcp-segment-mismatch yes
set network profiles zone-protection-profile Best_Practice_External remove-tcp-timestamp yes
set network profiles zone-protection-profile Best_Practice_External description "For internal zones only, drop Spoofed IP address packets to ensure that on ingress, the source address matches the firewall routing table."
set network profiles zone-protection-profile Best_Practice_External net-inspection rule 

set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood tcp-syn syn-cookies alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood tcp-syn syn-cookies activate-rate 0
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood tcp-syn syn-cookies maximal-rate 1000000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood tcp-syn enable no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood udp red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood udp red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood udp red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood udp enable no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmp red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmp red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmp red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmp enable no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmpv6 red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmpv6 red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmpv6 red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood icmpv6 enable no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood other-ip red alarm-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood other-ip red activate-rate 10000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood other-ip red maximal-rate 40000
set network profiles zone-protection-profile Best_Practice_Internal_ONLY flood other-ip enable no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8001 action alert 
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8001 interval 2
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8001 threshold 100
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8002 action alert 
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8002 interval 10
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8002 threshold 100
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8003 action alert 
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8003 interval 2
set network profiles zone-protection-profile Best_Practice_Internal_ONLY scan 8003 threshold 100
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-unknown-option yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-malformed-option yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY ipv6 routing-header-0 no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY ipv6 routing-header-1 no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY ipv6 routing-header-4-252 no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY ipv6 routing-header-255 no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-ip-spoof yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY strict-ip-check no
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-strict-source-routing yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-loose-source-routing yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-tcp-split-handshake yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY discard-overlapping-tcp-segment-mismatch yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY remove-tcp-timestamp yes
set network profiles zone-protection-profile Best_Practice_Internal_ONLY description "For internal zones only, drop Spoofed IP address packets to ensure that on ingress, the source address matches the firewall routing table."
set network profiles zone-protection-profile Best_Practice_Internal_ONLY net-inspection rule 

#General Reports
set shared reports "Host-visit malicious sites plus" period last-7-calendar-days
set shared reports "Host-visit malicious sites plus" topn 500
set shared reports "Host-visit malicious sites plus" topm 50
set shared reports "Host-visit malicious sites plus" caption "Host-visit malicious sites plus"
set shared reports "Host-visit malicious sites plus" frequency daily
set shared reports "Host-visit malicious sites plus" query "(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)"
set shared reports "Host-visit malicious sites plus" type url sortby repeatcnt
set shared reports "Host-visit malicious sites plus" type url group-by src
set shared reports "Host-visit malicious sites plus" type url aggregate-by [ from srcuser category action ]
set shared reports "Host-visit malicious sites plus" type url values repeatcnt
set shared reports "Hosts visit malicious sites" period last-7-calendar-days
set shared reports "Hosts visit malicious sites" topn 500
set shared reports "Hosts visit malicious sites" topm 50
set shared reports "Hosts visit malicious sites" caption "Hosts visit malicious sites"
set shared reports "Hosts visit malicious sites" frequency daily
set shared reports "Hosts visit malicious sites" query "(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)"
set shared reports "Hosts visit malicious sites" type url sortby repeatcnt
set shared reports "Hosts visit malicious sites" type url group-by src
set shared reports "Hosts visit malicious sites" type url aggregate-by [ from srcuser ]
set shared reports "Hosts visit malicious sites" type url values repeatcnt
set shared reports "Hosts visit questionable sites" period last-7-calendar-days
set shared reports "Hosts visit questionable sites" topn 500
set shared reports "Hosts visit questionable sites" topm 50
set shared reports "Hosts visit questionable sites" caption "Hosts visit questionable sites"
set shared reports "Hosts visit questionable sites" frequency daily
set shared reports "Hosts visit questionable sites" query "(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)"
set shared reports "Hosts visit questionable sites" type url sortby repeatcnt
set shared reports "Hosts visit questionable sites" type url group-by src
set shared reports "Hosts visit questionable sites" type url aggregate-by [ from srcuser ]
set shared reports "Hosts visit questionable sites" type url values repeatcnt
set shared reports "Host-visit quest sites plus" period last-7-calendar-days
set shared reports "Host-visit quest sites plus" topn 500
set shared reports "Host-visit quest sites plus" topm 50
set shared reports "Host-visit quest sites plus" caption "Host-visit quest sites plus"
set shared reports "Host-visit quest sites plus" frequency daily
set shared reports "Host-visit quest sites plus" query "(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)"
set shared reports "Host-visit quest sites plus" description "Detail of hosts visiting questionable URLs"
set shared reports "Host-visit quest sites plus" type url sortby repeatcnt
set shared reports "Host-visit quest sites plus" type url group-by src
set shared reports "Host-visit quest sites plus" type url aggregate-by [ from srcuser category action ]
set shared reports "Host-visit quest sites plus" type url values repeatcnt
set shared reports "Wildfire malicious verdicts" period last-30-calendar-days
set shared reports "Wildfire malicious verdicts" topn 500
set shared reports "Wildfire malicious verdicts" topm 10
set shared reports "Wildfire malicious verdicts" caption "Wildfire malicious verdicts"
set shared reports "Wildfire malicious verdicts" frequency daily
set shared reports "Wildfire malicious verdicts" query "(app neq smtp) and (category neq benign)"
set shared reports "Wildfire malicious verdicts" description "Files uploaded or downloaded that were later found to be malicious. This is a summary. Act on real-time email."
set shared reports "Wildfire malicious verdicts" type wildfire sortby repeatcnt
set shared reports "Wildfire malicious verdicts" type wildfire aggregate-by [ filedigest container-of-app app category filetype rule ]
set shared reports "Wildfire malicious verdicts" type wildfire values repeatcnt
set shared reports "Wildfire verdicts SMTP" period last-30-calendar-days
set shared reports "Wildfire verdicts SMTP" topn 500
set shared reports "Wildfire verdicts SMTP" topm 10
set shared reports "Wildfire verdicts SMTP" caption "Wildfire verdicts SMTP"
set shared reports "Wildfire verdicts SMTP" frequency daily
set shared reports "Wildfire verdicts SMTP" query "(app eq smtp) and (category neq benign)"
set shared reports "Wildfire verdicts SMTP" description "Links sent from emails found to be malicious. "
set shared reports "Wildfire verdicts SMTP" type wildfire sortby repeatcnt
set shared reports "Wildfire verdicts SMTP" type wildfire aggregate-by [ filedigest container-of-app app category filetype rule subject sender recipient misc ]
set shared reports "Clients sinkholed" period last-30-calendar-days
set shared reports "Clients sinkholed" topn 500
set shared reports "Clients sinkholed" topm 50
set shared reports "Clients sinkholed" caption "Clients sinkholed"
set shared reports "Clients sinkholed" query "(rule eq 'DNS Sinkhole Block')"
set shared reports "Clients sinkholed" frequency daily
set shared reports "Clients sinkholed" type traffic sortby repeatcnt
set shared reports "Clients sinkholed" type traffic group-by from
set shared reports "Clients sinkholed" type traffic aggregate-by [ src srcuser ]
set shared reports "Clients sinkholed" type traffic values repeatcnt

#Report Groups
set shared report-group "Possible Compromise" custom-widget 1 custom-report "Clients sinkholed"
set shared report-group "Possible Compromise" custom-widget 2 custom-report "Wildfire malicious verdicts"
set shared report-group "Possible Compromise" custom-widget 3 custom-report "Wildfire verdicts SMTP"
set shared report-group "Possible Compromise" custom-widget 4 custom-report "Hosts visit malicious sites"
set shared report-group "Possible Compromise" custom-widget 5 custom-report "Host-visit malicious sites plus"
set shared report-group "Possible Compromise" custom-widget 6 custom-report "Hosts visit questionable sites"
set shared report-group "Possible Compromise" custom-widget 7 custom-report "Host-visit quest sites plus"
set shared report-group "Possible Compromise" title-page yes
set shared report-group "Possible Compromise" variable title value "Possible Compromise"

